!function(e){var r={};function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)t.d(n,o,function(r){return e[r]}.bind(null,o));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=1)}([function(e,r,t){var n;void 0===(n=function(e,r){"use strict";r.__esModule=!0,r.VkOAuth2RedirectParamsError=r.VkOAuth2RedirectParamsSuccess=void 0;var t=function(){function e(e,r,t,n){this.accessToken=e,this.expiresIn=r,this.userId=t,this.state=n}return e.fromURLSearchParams=function(r){var t=r.get("access_token");if(null===t)return null;var n=r.get("expires_in");if(null===n)return null;var o=r.get("user_id");if(null===o)return null;var i=r.get("state");return new e(t,n,o,null!==i?i:void 0)},e.fromLocalStorage=function(){var r=localStorage.getItem("VkOAuth2RedirectParamsSuccess");if(null===r)return null;var t=JSON.parse(r);return new e(t.accessToken,t.expiresIn,t.userId,t.state)},e.store=function(e){localStorage.setItem("VkOAuth2RedirectParamsSuccess",JSON.stringify(e))},e.clearStorage=function(){localStorage.removeItem("VkOAuth2RedirectParamsSuccess")},e}();r.VkOAuth2RedirectParamsSuccess=t;var n=function(){function e(e,r){this.error=e,this.errorDescription=r}return e.fromURLSearchParams=function(r){var t=r.get("error");if(null===t)return null;var n=r.get("error_description");return null===n?null:new e(t,n)},e.fromSessionStorage=function(){var r=localStorage.getItem("VkOAuth2RedirectParamsError");if(null===r)return null;var t=JSON.parse(r);return new e(t.error,t.error_description)},e.store=function(e){sessionStorage.setItem("VkOAuth2RedirectParamsError",JSON.stringify(e))},e.clearStorage=function(){sessionStorage.removeItem("VkOAuth2RedirectParamsError")},e}();r.VkOAuth2RedirectParamsError=n}.apply(r,[t,r]))||(e.exports=n)},function(e,r,t){e.exports=t(2)},function(e,r,t){var n,o;n=[t,r,t(3)],void 0===(o=function(e,r,t){"use strict";r.__esModule=!0;try{var n=document.createElement("div");document.body.appendChild(n),t.App.init(new t.AppConfig("7540692","https://wf8p3bm55s.github.io/vkoauth","/oauth.html",n))}catch(e){alert(e.name+" "+e.message)}}.apply(r,n))||(e.exports=o)},function(e,r,t){var n,o;n=[t,r,t(4),t(5),t(7)],void 0===(o=function(e,r,t,n,o){"use strict";r.__esModule=!0,r.App=r.AppConfig=void 0;var i=function(e,r,t,n){this.appId=e,this.appUrl=r,this.redirectPath=t,this.rootElement=n};r.AppConfig=i;var u=function(){function e(){}return e.init=function(e){var r=new t.ViewEngine(e.rootElement),i=o.VkOAuth2Service.findToken();null!==i&&i.isValid()?new n.VkApiService(i).requestApi("execute.getSelfAnd5RandomFriendNames",{},1e4).then((function(e){console.log(e)}),(function(e){console.log(e)})):r.setupView(t.ViewEngine.getUnauthorizedView({authorizeBtnCLickCallback:function(){return o.VkOAuth2Service.authorize(e.appId,e.appUrl.concat(e.redirectPath),"page","friends",1)}}))},e}();r.App=u}.apply(r,n))||(e.exports=o)},function(e,r,t){var n;void 0===(n=function(e,r){"use strict";r.__esModule=!0,r.ViewEngine=r.AuthorizedViewModel=r.UnauthorizedViewModel=void 0;var t=function(e){this.authorizeBtnCLickCallback=e};r.UnauthorizedViewModel=t;var n=function(e,r){this.name=e,this.friends=r};r.AuthorizedViewModel=n;var o=function(){function e(e){this.rootElement=e}return e.getUnauthorizedView=function(e){var r=document.createElement("div"),t=document.createElement("button");return t.innerText="Авторизоваться",t.onclick=e.authorizeBtnCLickCallback,r.appendChild(t),r},e.getAuthorizedView=function(e){var r=document.createElement("div"),t=document.createElement("div"),n=document.createElement("div");return t.innerText="Имя авторизованного пользователя: "+e.name,n.innerText="Друзья пользователя: "+e.friends.join(", "),r.appendChild(t),r.appendChild(n),r},e.prototype.setupView=function(e){for(;this.rootElement.firstChild;)this.rootElement.removeChild(this.rootElement.firstChild);this.rootElement.appendChild(e)},e}();r.ViewEngine=o}.apply(r,[t,r]))||(e.exports=n)},function(e,r,t){var n,o;n=[t,r,t(6)],void 0===(o=function(e,r,t){"use strict";r.__esModule=!0,r.VkApiService=void 0;var n=function(){function e(e){this.token=e}return e.prototype.buildApiUrl=function(r,t){var n=""+e.URL+r+"?";return n+=Object.keys(t).map((function(e){return e+"="+t[e]})).join("&"),n+="&access_token="+this.token.token,n+="&v="+e.VERSION},e.prototype.requestApi=function(e,r,n){var o=this.buildApiUrl(e,r);return t.JsonpService.get(o,n)},e.VERSION="5.120",e.URL="https://api.vk.com/method/",e}();r.VkApiService=n}.apply(r,n))||(e.exports=o)},function(e,r,t){var n;void 0===(n=function(e,r){"use strict";r.__esModule=!0,r.JsonpService=void 0;var t=function(){function e(){}return e.finishRequest=function(r){window.clearTimeout(e.requests[r].timeoutTimer),document.head.removeChild(e.requests[r].scriptElement),delete e.requests[r]},e.get=function(r,t){return new Promise((function(n,o){var i;do{i=Math.round(Math.random()*Math.pow(10,16)).toString()}while(i in e.requests);var u=document.createElement("script");u.onerror=function(r){e.finishRequest(i),o(r)},e.requests[i]={scriptElement:u,timeoutTimer:window.setTimeout((function(){e.finishRequest(i),o(new Error("Timeout"))}),t),callback:function(r){e.finishRequest(i),n(r)}},u.src=r+"&callback=JsonpService.requests["+i+"].callback",document.head.appendChild(u)}))},e}();r.JsonpService=t}.apply(r,[t,r]))||(e.exports=n)},function(e,r,t){var n,o;n=[t,r,t(0)],void 0===(o=function(e,r,t){"use strict";r.__esModule=!0,r.VkOAuth2Service=r.VkAuthorizeError=r.VkAccessToken=void 0;var n=function(){function e(e,r,t){this.token=e,this.tokenExpires=r,this.userId=t}return e.fromLocalStorage=function(){var r=localStorage.getItem("VkAccessToken");if(null===r)return null;var t=JSON.parse(r);return new e(t.token,t.tokenExpires,t.userId)},e.store=function(e){localStorage.setItem("VkAccessToken",JSON.stringify(e))},e.clearStorage=function(){localStorage.removeItem("VkAccessToken")},e.prototype.isValid=function(){return(new Date).getTime()<this.tokenExpires},e}();r.VkAccessToken=n;var o=function(){function e(e,r){this.error=e,this.errorDescription=r}return e.fromSessionStorage=function(){var r=sessionStorage.getItem("VkAuthorizeError");if(null===r)return null;var t=JSON.parse(r);return new e(t.error,t.errorDescription)},e.store=function(e){localStorage.setItem("VkAuthorizeError",JSON.stringify(e))},e.clearStorage=function(){sessionStorage.removeItem("VkAuthorizeError")},e}();r.VkAuthorizeError=o;var i=function(){function e(){}return e.findToken=function(){var e=n.fromLocalStorage(),r=t.VkOAuth2RedirectParamsSuccess.fromLocalStorage();if(null!==e)return null!==r&&t.VkOAuth2RedirectParamsSuccess.clearStorage(),e;if(null===r)return null;if(void 0!==r.state){var o=parseInt(r.state);if(!Number.isNaN(o)){var i=o+1e3*parseInt(r.expiresIn);e=new n(r.accessToken,i,r.userId),n.store(e)}}return t.VkOAuth2RedirectParamsSuccess.clearStorage(),e},e.findAuthorizeError=function(){var e=o.fromSessionStorage(),r=t.VkOAuth2RedirectParamsError.fromSessionStorage();return null!==e?(null!==r&&t.VkOAuth2RedirectParamsError.clearStorage(),e):null===r?null:(e=new o(r.error,r.errorDescription),o.store(e),t.VkOAuth2RedirectParamsError.clearStorage(),e)},e.buildAuthorizeUrl=function(r,t,n,o,i,u,a){var c=e.URL;return c+="?client_id="+r,c+="&redirect_uri="+t,null!=n&&(c+="&display="+n),null!=o&&(c+="&scope="+o),null!=i&&(c+="&response_type="+i),null!=u&&(c+="&state="+u),null!=a&&(c+="&revoke="+a),c},e.authorize=function(r,t,n,o,i){var u=e.buildAuthorizeUrl(r,t,n,o,"token",(new Date).getTime().toString(),i);location.replace(u)},e.URL="https://oauth.vk.com/authorize",e}();r.VkOAuth2Service=i}.apply(r,n))||(e.exports=o)}]);